<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Urdu Document Editor</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jameel+Noori+Nastaleeq&display=swap" rel="stylesheet">
    
    <style>
        /* --- General Styling --- */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f7f9;
        }

        h2 {
            text-align: center;
            color: #1a5276;
            font-family: 'Jameel Noori Nastaleeq', Arial, sans-serif;
            margin-bottom: 30px;
        }

        /* --- Document Editor Area --- */
        #document-editor {
            min-height: 400px;
            padding: 20px;
            border: 1px solid #ccc;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            
            /* Urdu Specific Styles */
            direction: rtl; 
            text-align: right;
            font-family: 'Jameel Noori Nastaleeq', 'Simplified Arabic', sans-serif;
            font-size: 24px;
            line-height: 1.8;
            outline: none; 
            word-wrap: break-word; 
        }
        
        [contenteditable]:empty::before {
            content: attr(placeholder);
            color: #aaa;
            cursor: text;
        }

        /* --- Toolbar Buttons --- */
        #toolbar {
            margin-bottom: 15px;
            text-align: right;
        }
        .tool-btn {
            background-color: #5d98bc;
            color: white;
            border: none;
            padding: 8px 15px;
            margin-left: 5px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .tool-btn:hover {
            background-color: #3b7496;
        }

        /* --- Virtual Keyboard Layout --- */
        #keyboard-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-end; 
            max-width: 900px;
            margin: 0 auto 30px auto;
            border-radius: 8px;
            padding: 10px;
            background-color: #e8eef2;
            border: 1px solid #ddd;
        }

        .urdu-key {
            background-color: #ffffff;
            color: #333;
            border: 1px solid #ccc;
            margin: 3px;
            padding: 5px 10px; /* Adjusted padding to fit text + span */
            cursor: pointer;
            border-radius: 4px;
            font-size: 24px; /* Slightly smaller for better fit */
            font-family: 'Jameel Noori Nastaleeq', Arial, sans-serif;
            min-width: 45px;
            text-align: center;
            line-height: 1.2;
            transition: background-color 0.1s, transform 0.1s;
        }

        /* Styling for the small Latin phonetic key inside the button */
        .urdu-key span { 
            display: block; 
            font-size: 14px; 
            font-family: Arial, sans-serif; 
            color: #555; 
            margin-top: 3px;
        }

        .urdu-key:hover {
            background-color: #c9e0f0;
        }

        .urdu-key.space { width: 150px; }
        .urdu-key.special { background-color: #f1c40f; font-size: 18px; }
        .urdu-key.special:hover { background-color: #d8a70c; }

    </style>
</head>
<body>

    <h2>Ø§Ø±Ø¯Ùˆ Ø¢Ù† Ù„Ø§Ø¦Ù† ÚˆØ§Ú©ÙˆÙ…Ù†Ù¹ Ø§ÛŒÚˆÛŒÙ¹Ø± â€¢ Online Urdu Document Editor</h2>

    <div id="toolbar">
        <button class="tool-btn" onclick="insertImage()">ğŸ–¼ï¸ Image</button>
        <button class="tool-btn" onclick="insertTable()">ğŸ“… Table</button>
        <button class="tool-btn" onclick="insertShape()">â¬› Shape/Box</button>
        <button class="tool-btn" onclick="saveDocument()">ğŸ’¾ Save Text</button>
    </div>

    <div 
        id="document-editor" 
        contenteditable="true" 
        dir="rtl" 
        placeholder="ÛŒÛØ§Úº Ù„Ú©Ú¾Ù†Ø§ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº... Start writing here. Use your Latin keyboard phonetically (a=Ø§, p=Ù¾, etc.)"
    ></div>

    <div id="keyboard-container" dir="rtl">
        
        <button class="urdu-key" data-char="Ø§">Ø§<span>a</span></button>
        <button class="urdu-key" data-char="Ø¢">Ø¢<span>A</span></button>
        <button class="urdu-key" data-char="Ø¨">Ø¨<span>b</span></button>
        <button class="urdu-key" data-char="Ù¾">Ù¾<span>p</span></button>
        <button class="urdu-key" data-char="Øª">Øª<span>t</span></button>
        <button class="urdu-key" data-char="Ù¹">Ù¹<span>T</span></button>
        <button class="urdu-key" data-char="Ø«">Ø«<span>C</span></button>
        <button class="urdu-key" data-char="Ø¬">Ø¬<span>j</span></button>
        <button class="urdu-key" data-char="Ú†">Ú†<span>c</span></button>
        <button class="urdu-key" data-char="Ø­">Ø­<span>H</span></button>
        <button class="urdu-key" data-char="Ø®">Ø®<span>K</span></button>
        <button class="urdu-key" data-char="Ø¯">Ø¯<span>d</span></button>
        <button class="urdu-key" data-char="Úˆ">Úˆ<span>D</span></button>
        <button class="urdu-key" data-char="Ø°">Ø°<span>Z</span></button>
        <button class="urdu-key" data-char="Ø±">Ø±<span>r</span></button>
        <button class="urdu-key" data-char="Ú‘">Ú‘<span>R</span></button>
        <button class="urdu-key" data-char="Ø²">Ø²<span>z</span></button>
        <button class="urdu-key" data-char="Ú˜">Ú˜<span>x</span></button>
        <button class="urdu-key" data-char="Ø³">Ø³<span>s</span></button>
        <button class="urdu-key" data-char="Ø´">Ø´<span>S</span></button>
        <button class="urdu-key" data-char="Øµ">Øµ<span>q</span></button>
        <button class="urdu-key" data-char="Ø¶">Ø¶<span>X</span></button>
        <button class="urdu-key" data-char="Ø·">Ø·<span>I</span></button>
        <button class="urdu-key" data-char="Ø¸">Ø¸<span>O</span></button>
        <button class="urdu-key" data-char="Ø¹">Ø¹<span>e</span></button>
        <button class="urdu-key" data-char="Øº">Øº<span>G</span></button>
        <button class="urdu-key" data-char="Ù">Ù<span>f</span></button>
        <button class="urdu-key" data-char="Ù‚">Ù‚<span>Q</span></button>
        <button class="urdu-key" data-char="Ú©">Ú©<span>k</span></button>
        <button class="urdu-key" data-char="Ú¯">Ú¯<span>g</span></button>
        <button class="urdu-key" data-char="Ù„">Ù„<span>l</span></button>
        <button class="urdu-key" data-char="Ù…">Ù…<span>m</span></button>
        <button class="urdu-key" data-char="Ù†">Ù†<span>n</span></button>
        <button class="urdu-key" data-char="Úº">Úº<span>N</span></button>
        <button class="urdu-key" data-char="Ùˆ">Ùˆ<span>w/u/v</span></button>
        <button class="urdu-key" data-char="Û">Û<span>h</span></button>
        <button class="urdu-key" data-char="Ú¾">Ú¾<span>Hh</span></button>
        <button class="urdu-key" data-char="ÛŒ">ÛŒ<span>i/y</span></button>
        <button class="urdu-key" data-char="Û’">Û’<span>Y/E</span></button>
        <button class="urdu-key" data-char="Ø¡">Ø¡<span>'</span></button>
        
        <button class="urdu-key special" data-char="ØŸ">ØŸ<span>?</span></button>
        <button class="urdu-key special" data-char="!">!<span>!</span></button>
        <button class="urdu-key special" data-char="ØŒ">ØŒ<span>,</span></button>
        <button class="urdu-key special" data-char="Û”">Û”<span>.</span></button>
        
        <button class="urdu-key special" data-char="Û°">Û°<span>0</span></button>
        <button class="urdu-key special" data-char="Û±">Û±<span>1</span></button>
        <button class="urdu-key special" data-char="Û²">Û²<span>2</span></button>
        <button class="urdu-key special" data-char="Û³">Û³<span>3</span></button>
        <button class="urdu-key special" data-char="Û´">Û´<span>4</span></button>
        <button class="urdu-key special" data-char="Ûµ">Ûµ<span>5</span></button>
        <button class="urdu-key special" data-char="Û¶">Û¶<span>6</span></button>
        <button class="urdu-key special" data-char="Û·">Û·<span>7</span></button>
        <button class="urdu-key special" data-char="Û¸">Û¸<span>8</span></button>
        <button class="urdu-key special" data-char="Û¹">Û¹<span>9</span></button>

        <button class="urdu-key space" data-char=" ">Space</button>
        <button class="urdu-key special" onclick="document.execCommand('undo', false, null)">â†©ï¸ Undo</button>
        <button class="urdu-key special" onclick="document.execCommand('delete', false, null)">âŒ Backspace</button>
        <button class="urdu-key special" data-char="\n">â Enter</button>
        
    </div>

<script>
    const editor = document.getElementById('document-editor');
    const keys = document.querySelectorAll('.urdu-key');

    // --- 1. Phonetic Key Mapping (Latin to Urdu) ---
    const phoneticMap = {
        // Lowercase and Basic Mappings
        'a': 'Ø§', 'b': 'Ø¨', 'p': 'Ù¾', 't': 'Øª', 'j': 'Ø¬', 'c': 'Ú†', 'H': 'Ø­', 
        'k': 'Ú©', 'g': 'Ú¯', 'l': 'Ù„', 'm': 'Ù…', 'n': 'Ù†', 'd': 'Ø¯', 'r': 'Ø±', 
        'z': 'Ø²', 's': 'Ø³', 'S': 'Ø´', 'x': 'Øµ', 'f': 'Ù', 'q': 'Ù‚', 
        'v': 'Ùˆ', 'w': 'Ùˆ', 'u': 'Ùˆ', 'i': 'ÛŒ', 'y': 'ÛŒ', 'e': 'Û’',
        'h': 'Û', 
        
        // Aspirated and Taa/Daa/Raa with dot (Shifted keys)
        'A': 'Ø¢',   // Alif Madda (Shift+A)
        'T': 'Ù¹',   // Tta (Shift+T)
        'D': 'Úˆ',   // Ddal (Shift+D)
        'R': 'Ú‘',   // Rra (Shift+R)
        'Z': 'Ø°',   // Dhal (Shift+Z)
        'X': 'Ø¶',   // Zaad (Shift+X)
        'I': 'Ø·',   // Toh (Shift+I)
        'E': 'Ø¹',   // Ain (Shift+E)
        'G': 'Øº',   // Ghain (Shift+G)
        'N': 'Úº',   // Noon Ghunnah (Shift+N)
        'O': 'Ø¤',   // Wao Hamza (Shift+O)
        'Y': 'Û’',   // Bari Ye (Shift+Y)
        'C': 'Ø«',   // Sa (Shift+C)

        // Special characters and Diacritics (using symbols/other keys)
        "'": 'Ø¡',   // Hamza
        ';': 'Ø›',   // Semicolon

        // Punctuation and Digits
        ',': 'ØŒ', '.': 'Û”', '?': 'ØŸ', '!': '!',
        '0': 'Û°', '1': 'Û±', '2': 'Û²', '3': 'Û³', '4': 'Û´', 
        '5': 'Ûµ', '6': 'Û¶', '7': 'Û·', '8': 'Û¸', '9': 'Û¹',
        ' ': ' ' // Space
    };

    // --- 2. Keyboard Input Logic (Virtual Buttons) ---
    keys.forEach(key => {
        key.addEventListener('click', () => {
            const char = key.getAttribute('data-char');
            if (char) {
                editor.focus();
                document.execCommand('insertText', false, char);
            }
        });
    });

    // --- 3. Physical Keyboard Typing Logic (Phonetic) ---
    editor.addEventListener('keydown', (event) => {
        let key = event.key;
        let urduChar = null;

        // Check for shifted/capital keys first
        if (event.shiftKey) {
            // Check for uppercase phonetic map (e.g., 'A' for Alif Madda)
            if (phoneticMap.hasOwnProperty(key.toUpperCase())) {
                 urduChar = phoneticMap[key.toUpperCase()];
            } else if (key === 'h') {
                urduChar = 'Ú¾'; // Do Chashmi Heh via Shift+h
            }
        } 
        
        // Check for standard/lowercase keys (unless already mapped by shift)
        if (urduChar === null && phoneticMap.hasOwnProperty(key)) {
            urduChar = phoneticMap[key];
        }


        // Only proceed if a valid Urdu character was mapped, and it's not a control key
        if (urduChar !== null && key.length <= 1 && !event.ctrlKey && !event.altKey) {
             // Prevent default browser action (like typing Latin 'a')
            event.preventDefault(); 
            document.execCommand('insertText', false, urduChar);
        }
    });


    // --- 4. Rich Content Insertion Functions ---

    function insertImage() {
        const url = prompt("ØªØµÙˆÛŒØ± Ú©Ø§ ÛŒÙˆ Ø¢Ø± Ø§ÛŒÙ„ Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº (Enter the image URL):");
        if (url) {
            editor.focus();
            document.execCommand('insertImage', false, url);
        }
    }

    function insertTable() {
        const tableHTML = `
            <table border="1" style="width: 100%; margin: 15px 0; border-collapse: collapse; text-align: right; direction: rtl;">
                <tr>
                    <th style="padding: 10px; background-color: #eee;">Ù¾ÛÙ„ÛŒ Ø³Ø±Ø®ÛŒ</th>
                    <th style="padding: 10px; background-color: #eee;">Ø¯ÙˆØ³Ø±ÛŒ Ø³Ø±Ø®ÛŒ</th>
                </tr>
                <tr>
                    <td style="padding: 8px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§ÛŒÚ©</td>
                    <td style="padding: 8px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¯Ùˆ</td>
                </tr>
            </table>
        `;
        editor.focus();
        document.execCommand('insertHTML', false, tableHTML);
    }

    function insertShape() {
        const shapeHTML = `
            <div style="border: 3px solid #1a5276; padding: 15px; margin: 15px; background-color: #e6f3fa; border-radius: 8px; font-weight: bold; width: fit-content; direction: rtl; display: inline-block;">
                Ø¶Ø±ÙˆØ±ÛŒ Ù†ÙˆÙ¹: ÛŒÛØ§Úº Ø§ÛÙ… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù„Ú©Ú¾ÛŒÚº
            </div>
        `;
        editor.focus();
        document.execCommand('insertHTML', false, shapeHTML);
    }

    function saveDocument() {
        const content = editor.innerHTML;
        const blob = new Blob([content], { type: 'text/html;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = 'Urdu_Document.html';
        
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        
        URL.revokeObjectURL(url);
        
        alert("Document saved as Urdu_Document.html! (ÚˆØ§Ú©ÙˆÙ…ÛŒÙ†Ù¹ Ù…Ø­ÙÙˆØ¸ ÛÙˆ Ú¯ÛŒØ§)");
    }

</script>
</body>
</html>